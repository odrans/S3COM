\hypertarget{namespacemod__cld__legcoef}{}\doxysection{mod\+\_\+cld\+\_\+legcoef Module Reference}
\label{namespacemod__cld__legcoef}\index{mod\_cld\_legcoef@{mod\_cld\_legcoef}}


Module dealing with computing and loading the coefficients of the Legendre polynomials.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \mbox{\hyperlink{namespacemod__cld__legcoef_ac4b9447eacf078b1abdacb5e7e3d1e47}{cld\+\_\+legcoef\+\_\+load}} (cld\+\_\+mie)
\begin{DoxyCompactList}\small\item\em Export the coefficients of Legendre polynomials expansion of the phase function. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemod__cld__legcoef_a4d185f9e433f07940c9a7c47af1f20ec}{cld\+\_\+legcoef\+\_\+compute}} (cld\+\_\+mie)
\begin{DoxyCompactList}\small\item\em Compute the Legendre polynomials expansion coefficients from the phase function. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemod__cld__legcoef_a35af7a29b7a26cbf1bd5ba659751ffdb}{cld\+\_\+legcoef\+\_\+read}} (cld\+\_\+mie)
\begin{DoxyCompactList}\small\item\em Read the Legendre polynomials expansion coefficients from a net\+CDF file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemod__cld__legcoef_a0a72bcd6ff9c0de761b8916aa6afce16}{cld\+\_\+legcoef\+\_\+write}} (cld\+\_\+mie)
\begin{DoxyCompactList}\small\item\em Write the Legendre polynomials expansion coefficients to a net\+CDF file. \end{DoxyCompactList}\item 
character(len=\+:) function, allocatable \mbox{\hyperlink{namespacemod__cld__legcoef_ae0d3b1f031a490d3fa29465382536ce5}{fn\+\_\+legcoef}} (fn, nmom)
\begin{DoxyCompactList}\small\item\em Finds the name of the net\+CDF file containing the Legendre coefficients. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Module dealing with computing and loading the coefficients of the Legendre polynomials. 

This module contains the following functions\+:
\begin{DoxyItemize}
\item {\ttfamily cld\+\_\+legcoef\+\_\+load} \+: Export the coefficients of Legendre polynomials expansion of the phase function
\item {\ttfamily cld\+\_\+legcoef\+\_\+compute} \+: Compute the Legendre polynomials expansion coefficients from the phase function
\item {\ttfamily cld\+\_\+legcoef\+\_\+read} \+: Read the Legendre polynomials expansion coefficients from a net\+CDF file
\item {\ttfamily cld\+\_\+legcoef\+\_\+write} \+: Write the Legendre polynomials expansion coefficients in a net\+CDF file 
\end{DoxyItemize}

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacemod__cld__legcoef_a4d185f9e433f07940c9a7c47af1f20ec}\label{namespacemod__cld__legcoef_a4d185f9e433f07940c9a7c47af1f20ec}} 
\index{mod\_cld\_legcoef@{mod\_cld\_legcoef}!cld\_legcoef\_compute@{cld\_legcoef\_compute}}
\index{cld\_legcoef\_compute@{cld\_legcoef\_compute}!mod\_cld\_legcoef@{mod\_cld\_legcoef}}
\doxysubsubsection{\texorpdfstring{cld\_legcoef\_compute()}{cld\_legcoef\_compute()}}
{\footnotesize\ttfamily subroutine mod\+\_\+cld\+\_\+legcoef\+::cld\+\_\+legcoef\+\_\+compute (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structs3com__types_1_1type__cld__mie}{type\+\_\+cld\+\_\+mie}}), intent(inout)}]{cld\+\_\+mie }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Compute the Legendre polynomials expansion coefficients from the phase function. 

The internal RTTOV function {\ttfamily rttov\+\_\+legcoef\+\_\+calc} is used to compute the coefficients from the phase function in {\ttfamily cld\+\_\+mie}. The coefficients are then stored in {\ttfamily cld\+\_\+mielegcoef}. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em cld\+\_\+mie} & Structure containing Mie optical properties \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacemod__cld__legcoef_ac4b9447eacf078b1abdacb5e7e3d1e47}\label{namespacemod__cld__legcoef_ac4b9447eacf078b1abdacb5e7e3d1e47}} 
\index{mod\_cld\_legcoef@{mod\_cld\_legcoef}!cld\_legcoef\_load@{cld\_legcoef\_load}}
\index{cld\_legcoef\_load@{cld\_legcoef\_load}!mod\_cld\_legcoef@{mod\_cld\_legcoef}}
\doxysubsubsection{\texorpdfstring{cld\_legcoef\_load()}{cld\_legcoef\_load()}}
{\footnotesize\ttfamily subroutine, public mod\+\_\+cld\+\_\+legcoef\+::cld\+\_\+legcoef\+\_\+load (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structs3com__types_1_1type__cld__mie}{type\+\_\+cld\+\_\+mie}}), intent(inout)}]{cld\+\_\+mie }\end{DoxyParamCaption})}



Export the coefficients of Legendre polynomials expansion of the phase function. 

This subroutine writes the coefficients of Legendre polynomials expansion of the phase function in the cld\+\_\+mie structure. The coefficients are either computed from the phase function or read from a net\+CDF file. If that files does not exist, it is created. The new netcdf file has the same name as {\ttfamily fn\+\_\+mie} but with the extension \char`\"{}\+\_\+legcoef\+\_\+nmom\+\_\+.\+nc\char`\"{}, with nmom the number of Legendre polynomials used. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em cld\+\_\+mie} & Structure containing Mie optical properties \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacemod__cld__legcoef_a35af7a29b7a26cbf1bd5ba659751ffdb}\label{namespacemod__cld__legcoef_a35af7a29b7a26cbf1bd5ba659751ffdb}} 
\index{mod\_cld\_legcoef@{mod\_cld\_legcoef}!cld\_legcoef\_read@{cld\_legcoef\_read}}
\index{cld\_legcoef\_read@{cld\_legcoef\_read}!mod\_cld\_legcoef@{mod\_cld\_legcoef}}
\doxysubsubsection{\texorpdfstring{cld\_legcoef\_read()}{cld\_legcoef\_read()}}
{\footnotesize\ttfamily subroutine mod\+\_\+cld\+\_\+legcoef\+::cld\+\_\+legcoef\+\_\+read (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structs3com__types_1_1type__cld__mie}{type\+\_\+cld\+\_\+mie}})}]{cld\+\_\+mie }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Read the Legendre polynomials expansion coefficients from a net\+CDF file. 

Legendre expansion coefficients are read from the net\+CDF file {\ttfamily cld\+\_\+miefn\+\_\+legcoef} and stored in {\ttfamily cld\+\_\+mielegcoef}. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em cld\+\_\+mie} & Structure containing Mie optical properties \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacemod__cld__legcoef_a0a72bcd6ff9c0de761b8916aa6afce16}\label{namespacemod__cld__legcoef_a0a72bcd6ff9c0de761b8916aa6afce16}} 
\index{mod\_cld\_legcoef@{mod\_cld\_legcoef}!cld\_legcoef\_write@{cld\_legcoef\_write}}
\index{cld\_legcoef\_write@{cld\_legcoef\_write}!mod\_cld\_legcoef@{mod\_cld\_legcoef}}
\doxysubsubsection{\texorpdfstring{cld\_legcoef\_write()}{cld\_legcoef\_write()}}
{\footnotesize\ttfamily subroutine mod\+\_\+cld\+\_\+legcoef\+::cld\+\_\+legcoef\+\_\+write (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structs3com__types_1_1type__cld__mie}{type\+\_\+cld\+\_\+mie}}), intent(in)}]{cld\+\_\+mie }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Write the Legendre polynomials expansion coefficients to a net\+CDF file. 

Legendre expansion coefficients created by {\ttfamily cld\+\_\+legcoef\+\_\+compute} are written to the net\+CDF file {\ttfamily cld\+\_\+miefn\+\_\+legcoef}. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em cld\+\_\+mie} & Structure containing Mie optical properties \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacemod__cld__legcoef_ae0d3b1f031a490d3fa29465382536ce5}\label{namespacemod__cld__legcoef_ae0d3b1f031a490d3fa29465382536ce5}} 
\index{mod\_cld\_legcoef@{mod\_cld\_legcoef}!fn\_legcoef@{fn\_legcoef}}
\index{fn\_legcoef@{fn\_legcoef}!mod\_cld\_legcoef@{mod\_cld\_legcoef}}
\doxysubsubsection{\texorpdfstring{fn\_legcoef()}{fn\_legcoef()}}
{\footnotesize\ttfamily character(len=\+:) function, allocatable mod\+\_\+cld\+\_\+legcoef\+::fn\+\_\+legcoef (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{fn,  }\item[{integer, intent(in)}]{nmom }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Finds the name of the net\+CDF file containing the Legendre coefficients. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fn} & Name of the net\+CDF file containing the Mie coefficients \\
\hline
\mbox{\texttt{ in}}  & {\em nmom} & Number of Legendre moments \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Name of the net\+CDF file containing the Legendre coefficients 
\end{DoxyReturn}
